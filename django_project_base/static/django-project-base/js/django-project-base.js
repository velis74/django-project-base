(function(e){function t(t){for(var n,i,s=t[0],l=t[1],d=t[2],u=0,p=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);c&&c(t);while(p.length)p.shift()();return o.push.apply(o,d||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==r[l]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var c=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0e0f":function(e,t,a){},"150b":function(e,t,a){},"154a":function(e,t,a){},"1d9d":function(e,t,a){},3051:function(e,t,a){"use strict";a("1d9d")},3646:function(e,t,a){"use strict";a("bc54")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("54ba");var n=a("a026"),r=(a("d3b7"),a("bc3a")),o=a.n(r),i=(a("99af"),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";n["a"].notify({title:e,text:t,type:a,data:{onNotificationClose:function(e,t){t()}}})}),s=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=-1,o=new Date(1e3*e.delayed_to_timestamp);n["a"].notify({title:e.message.subject,text:"\n        ".concat(e.message.body,"\n        <br>\n        ").concat(e.message.footer,"\n        <br>\n        <br>\n        Maintenance starts at: ").concat(o,"\n    "),duration:r,type:"error",data:{onNotificationClose:function(e,t,n){n||(a&&a(),t())},id:e.id,duration:r}})},l=function(e){var t={title:window.gettext("Error"),type:"error",data:{onNotificationClose:function(e,t){t()}}};e&&(t.text=e),n["a"].notify(t)},d=a("d4ec"),c=a("bee2"),u=function(){function e(){Object(d["a"])(this,e)}return Object(c["a"])(e,null,[{key:"store",value:function(){return localStorage}},{key:"get",value:function(t){var a=e.store().getItem(t);return a?JSON.parse(a).__val:null}},{key:"set",value:function(t,a){null!==a&&e.store().setItem(t,JSON.stringify({__val:a}))}},{key:"delete",value:function(t){e.store().removeItem(t)}},{key:"clear",value:function(){e.store().clear()}}]),e}(),p=o.a.create({xsrfCookieName:window.csrf_token_name||"__Host-csrftoken",xsrfHeaderName:"X-CSRFToken",withCredentials:!0}),m=401;p.interceptors.request.use((function(e){return e.headers["Content-Type"]="application/json",e.headers["Current-Project"]=u.get("current-project"),e.headers["X-CSRFToken"]||("undefined"!==typeof dynamicforms&&dynamicforms.csrf_token?e.headers["X-CSRFToken"]=dynamicforms.csrf_token:window.csrf_token&&(e.headers["X-CSRFToken"]=window.csrf_token)),e}),(function(e){return Promise.reject(e)})),p.interceptors.response.use((function(e){return Promise.resolve(e)}),(function(e){var t=e&&e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:"",a=e&&e.response&&e.response.status?parseInt(e.response.status,10):null,n=a===m,r=e.config&&!0===e.config.hideErrorNotice;return n&&u.clear(),r||l(t),Promise.reject(e)}));var f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a(e.component+"Modal",{tag:"component"})],1)},h=[];const g={UI:"Bootstrap",getObjectFromPath:e=>{if(e)try{return e.split(".").reduce((e,t)=>e[t]||{},window)}catch(t){console.error(t)}}};window.dynamicforms=g;var v=g,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:"modal fade "+e.className,attrs:{id:e.uuid,tabindex:"-1",role:"dialog","aria-hidden":"true"}},[a("div",{class:"modal-dialog "+e.sizeClass,attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{class:"modal-header "+e.headerClasses},[a("h5",{staticClass:"modal-title"},[e._v(e._s(e.title))]),e._m(0)]),a("transition",{attrs:{name:"flip",mode:"out-in"}},[e.isComponent?a("div",{key:e.uniqId,staticClass:"modal-body"},[a(e.body.component,e._b({tag:"div"},"div",e.body,!1))],1):a("div",{key:e.uniqId,staticClass:"modal-body",domProps:{innerHTML:e._s(e.body)}})]),a("div",{staticClass:"modal-footer"},e._l(e.buttons,(function(t){return a("button",e._b({key:t.uuid,class:t.classes,attrs:{id:t.element_id||t.uuid,type:"button"},on:{click:function(a){return a.stopPropagation(),e.buttonClick(a,t,e.callback)}}},"button",t.arias,!1),[e._v(" "+e._s(t.label)+" ")])})),0)],1)])])},_=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])])}],y=(a("b378"),a("e3be")),w=a("bba9"),x=a.n(w),C=a("365e"),k=a.n(C);const D=2083,j=x.a.create({xsrfCookieName:"csrftoken",xsrfHeaderName:"X-CSRFToken",withCredentials:!1});let O=0;j.interceptors.request.use(e=>{const t=void 0===e.showProgress||e.showProgress;if(!e.url.includes("/dynamicforms/progress")&&t){const t=v.dialog.addRequest(++O);e.sequence=t.sequence,e.headers["x-df-timestamp"]=e.headers["x-df-timestamp"]||t.timestamp}if("get"===k.a.toLower(e.method)&&k.a.size(e.url)>D&&k.a.includes(k.a.map(k.a.keys(e.headers),e=>k.a.toLower(e)),"x-viewmode")){const e="Your request exceeds maximum length";throw v.dialog.message("error",e),new x.a.Cancel(e)}return e}),j.interceptors.response.use(e=>(v.dialog.removeRequest(e.config.sequence),e),e=>(v.dialog.removeRequest(e.config.sequence),Promise.reject(e)));var F=j,P=a("447f");const L=new P["default"];var E=L,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{attrs:{id:e.uuid}},[e._t("form-error",(function(){return[e.errorText?a("div",{staticClass:"alert alert-danger"},[a("small",{staticClass:"text-danger",attrs:{id:"form-"+e.uuid+"-err"}},[e._v(e._s(e.errorText))])]):e._e()]})),e._l(e.rows,(function(t,n){return a(t.component,{key:n,tag:"DFFormRow",attrs:{columns:t.columns,data:e.record,errors:e.errors}})}))],2)},I=[],S={name:"formFieldChangeMixin",props:{rows:{},uuid:{},record:{default:null}},data(){return{}},emits:["fieldValueChanged"],computed:{recordFields(){return Object.keys(this.record).reduce((e,t)=>(e[t]=this.record[t],e),{})}},beforeDestroy(){},mounted(){},watch:{recordFields:{handler:function(e,t){Object.keys(this.record).map(a=>(t[a]!==e[a]&&this.$emit(a+"-changed",{formID:this.uuid,newRec:e,oldRec:t,changedField:a}),null))},deep:!0}}},N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isHiddenSingle?a("DFFormColumn",{attrs:{def:e.writableColumns[0],data:e.data,errors:e.errors}}):a("div",{staticClass:"row align-items-end"},[e._t("before-columns"),e._l(e.writableColumns,(function(t,n){return a("DFFormColumn",{key:n,attrs:{def:t,data:e.data,errors:e.errors}})})),e._t("after-columns")],2)},q=[],B=Object.freeze({SUPPRESS:1,HIDDEN:5,INVISIBLE:8,FULL:10}),M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isGroup?a("div",{class:e.cssClasses},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header"},[e._v(" "+e._s(e.def.title)+" ")]),a("div",{staticClass:"card-body"},[a(e.def.field.render_params.form,{tag:"component",attrs:{def:e.def.field,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}})],1),e.def.footer?a("div",{staticClass:"card-footer"},[e._v(" "+e._s(e.def.footer)+" ")]):e._e()])]):e.isHidden?a(e.def.field.render_params.form,{tag:"component",attrs:{def:e.def.field,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}}):a("div",{class:e.cssClasses+e.columnClasses},[a(e.def.field.render_params.form,{tag:"component",attrs:{def:e.def.field,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText},on:{onValueConfirmed:e.onValueConfirmed}})],1)},$=[],H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DFWidgetBase",{key:e.fieldKey,attrs:{def:e.def,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}},[e.indeterminate?a("input",{directives:[{name:"indeterminate",rawName:"v-indeterminate",value:!0,expression:"true"}],class:e.def.render_params.field_class,attrs:{slot:"input",id:e.def.uuid,type:"checkbox",name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,readonly:e.readonly,disabled:!0===e.def.read_only},domProps:{checked:!1},on:{change:e.change},slot:"input"}):e._e(),e.indeterminate?e._e():a("input",{directives:[{name:"indeterminate",rawName:"v-indeterminate",value:!1,expression:"false"}],class:e.def.render_params.field_class,attrs:{slot:"input",id:e.def.uuid,type:"checkbox",name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,readonly:e.readonly,disabled:!0===e.def.read_only},domProps:{checked:e.internalValue},on:{change:e.change},slot:"input"})])},A=[],V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isHidden?a("input",{attrs:{type:"hidden",name:e.def.name},domProps:{value:e.data[e.def.name]}}):a("div",{class:e.def.render_params.container_class,attrs:{id:"container-"+e.def.uuid}},[!1===e.labelAfterElement&&e.showLabelOrHelpText?a("DFWidgetBaseLabel",{attrs:{data:e.data,def:e.def}}):e._e(),e._t("input"),e.labelAfterElement&&e.showLabelOrHelpText?a("DFWidgetBaseLabel",{attrs:{data:e.data,def:e.def}}):e._e(),e._t("help",(function(){return[e.def.help_text&&e.showLabelOrHelpText?a("small",{staticClass:"form-text text-muted",attrs:{id:e.def.name+"-help"}},[e._v(e._s(e.def.help_text))]):e._e()]})),e._t("error",(function(){return[e.getErrorText?a("small",{staticClass:"invalid-feedback d-block",attrs:{id:e.def.name+"-err"}},[e._v(e._s(e.getErrorText))]):e._e()]}))],2)},U=[],R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.def.label?a("label",{class:e.def.render_params.label_class,attrs:{id:"label-"+e.def.uuid,for:e.def.name}},[e._v(" "+e._s(e.def.label)+" ")]):e._e()},W=[],z={name:"DFWidgetBaseLabel",props:{def:{type:Object,required:!0},data:{type:Object,required:!1,default:()=>{}}}},K=z,G=a("2877"),J=Object(G["a"])(K,R,W,!1,null,"0549e1ce",null),X=J.exports,Q={name:"DFWidgetBase",components:{DFWidgetBaseLabel:X},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},computed:{isHidden(){return this.def.visibility.form===B.HIDDEN},labelAfterElement(){return this.def.render_params.label_after_element},getErrorText(){try{if(this.errors&&this.errors[this.def.name])return this.errors[this.def.name]}catch(e){}return""}}},Y=Q,Z=Object(G["a"])(Y,V,U,!1,null,"09f67ae8",null),ee=Z.exports,te={name:"DFWidgetCheckbox",components:{DFWidgetBase:ee},directives:{indeterminate:(e,t)=>{e.indeterminate=Boolean(t.value)}},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},data(){return{indeterminate:!1,readonly:!0===this.def.read_only,internalValue:!1,fieldKey:Math.round(1e3*Math.random())}},computed:{value:{get:function(){return this.data[this.def.name]},set:function(e){this.data[this.def.name]=e,this.$emit("onValueConfirmed",!0)}}},mounted(){this.indeterminate=this.def.allow_null&&(void 0===this.value||null===this.value),this.value&&(this.internalValue=!0),void 0!==this.value&&null!==this.value||(this.internalValue=null)},methods:{change(e){const t=k.a.clone(this.internalValue),a=e.currentTarget.checked;this.def.allow_null?(!0===t?(this.indeterminate=!0,this.internalValue=null):(null===t||void 0===t)&&this.indeterminate&&a?(this.indeterminate=!1,this.internalValue=!1):!1===t&&!0===a&&(this.internalValue=!0,this.indeterminate=!1),this.fieldKey=Math.round(1e3*Math.random()),this.value=k.a.clone(this.internalValue)):this.value=k.a.clone(a)}}},ae=te,ne=(a("3051"),Object(G["a"])(ae,H,A,!1,null,null,null)),re=ne.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DFWidgetBase",{attrs:{def:e.def,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}},[a("ckeditor",{attrs:{slot:"input",editor:e.editor,config:e.editorConfig},slot:"input",model:{value:e.editorData,callback:function(t){e.editorData=t},expression:"editorData"}})],1)},ie=[],se=a("35cb"),le=a.n(se),de=a("4b2a"),ce=a.n(de),ue={name:"DFWidgetCKEditor",components:{DFWidgetBase:ee,ckeditor:ce.a.component},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},data(){return{editor:le.a,editorData:"<p>Type some text...</p>",editorConfig:{}}}},pe=ue,me=Object(G["a"])(pe,oe,ie,!1,null,"0305d162",null),fe=me.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DFWidgetBase",{attrs:{def:e.def,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}},[a("div",{key:e.def.uuid,attrs:{slot:"input",id:e.def.uuid},slot:"input"},[a("div",{staticClass:"input-group"},[a("input",{key:e.fileInputKey,ref:"file",attrs:{type:"file",readonly:!0===e.def.read_only,disabled:!0===e.def.read_only,name:e.def.name},on:{change:e.selectFile}})]),a("div",[e.currentFile?a("div",{staticClass:"progress",staticStyle:{"margin-top":"0.3em"}},[a("div",{staticClass:"progress-bar progress-bar-info progress-bar-striped",style:{width:e.progress+"%"},attrs:{role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"}},[e._v(" "+e._s(e.progress)+"% ")])]):e._e(),a("div",[e.showFileOnServer?a("div",[e._v(" "+e._s(e.getFileName(e.currentFile?e.currentFile.name:e.data[e.def.name]))+" "),a("button",{staticClass:"close",staticStyle:{color:"red"},attrs:{type:"button","aria-label":"Close"},on:{click:e.removeFile}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("Ã—")])])]):e._e()])])])])},ge=[];const ve={getFileNameFromPath(e){return e?e.replace(/^.*[\\/]/,""):e}};var be=ve,_e={name:"DFWidgetFile",components:{DFWidgetBase:ee},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},data(){return{currentFile:void 0,progress:0,showFileOnServer:!1,fileInputKey:Math.round(1e3*Math.random())}},mounted(){this.showFileOnServer=!!k.a.clone(this.data[this.def.name])},methods:{getFileName(e){return be.getFileNameFromPath(e)},selectFile(){this.upload()},removeFile(){this.data[this.def.name]=null,this.progress=0,this.fileInputKey=Math.round(1e3*Math.random()),this.showFileOnServer=!1,this.currentFile=void 0},upload(){this.progress=0,this.currentFile=this.$refs.file.files.item(0);const e=new FormData;e.append("file",this.currentFile,""+this.currentFile.name),this.showFileOnServer=!0,this.progress=0,this.progress=45,this.progress=60,F.post("/dynamicforms/preupload-file/",e,{showProgress:!1}).then(e=>{this.data[this.def.name]=e.data.identifier,this.progress=100}).catch(e=>{this.progress=0,this.showFileOnServer=!1,this.currentFile=void 0,this.fileInputKey=Math.round(1e3*Math.random()),console.error(e)})}}},ye=_e,we=Object(G["a"])(ye,he,ge,!1,null,null,null),xe=we.exports,Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DFWidgetBase",{attrs:{def:e.def,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}},["checkbox"!==e.inputType||e.isTextArea?"radio"!==e.inputType||e.isTextArea?e.isTextArea?a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{slot:"input",id:e.def.uuid,name:e.def.name,placeholder:e.def.placeholder,maxlength:e.maxLength,rows:"4",readonly:!0===e.def.read_only,disabled:!0===e.def.read_only},domProps:{value:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onValueConfirmed(!0)},input:[function(t){t.target.composing||(e.value=t.target.value)},function(t){return e.onValueConfirmed(!1)}],change:function(t){return e.onValueConfirmed(!1)}},slot:"input"}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{slot:"input",id:e.def.uuid,name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,placeholder:e.def.placeholder,pattern:e.def.render_params.pattern,min:e.def.render_params.min,max:e.def.render_params.max,step:e.def.render_params.step,minlength:e.def.render_params.min_length,maxlength:e.maxLength,size:e.def.render_params.size,readonly:!0===e.def.read_only,disabled:!0===e.def.read_only,type:e.inputType},domProps:{value:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onValueConfirmed(!0)},input:[function(t){t.target.composing||(e.value=t.target.value)},function(t){return e.onValueConfirmed(!1)}],change:function(t){return e.onValueConfirmed(!1)}},slot:"input"}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{slot:"input",id:e.def.uuid,name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,placeholder:e.def.placeholder,pattern:e.def.render_params.pattern,min:e.def.render_params.min,max:e.def.render_params.max,step:e.def.render_params.step,minlength:e.def.render_params.min_length,maxlength:e.maxLength,size:e.def.render_params.size,readonly:!0===e.def.read_only,disabled:!0===e.def.read_only,type:"radio"},domProps:{checked:e._q(e.value,null)},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onValueConfirmed(!0)},input:function(t){return e.onValueConfirmed(!1)},change:[function(t){e.value=null},function(t){return e.onValueConfirmed(!1)}]},slot:"input"}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{slot:"input",id:e.def.uuid,name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,placeholder:e.def.placeholder,pattern:e.def.render_params.pattern,min:e.def.render_params.min,max:e.def.render_params.max,step:e.def.render_params.step,minlength:e.def.render_params.min_length,maxlength:e.maxLength,size:e.def.render_params.size,readonly:!0===e.def.read_only,disabled:!0===e.def.read_only,type:"checkbox"},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onValueConfirmed(!0)},input:function(t){return e.onValueConfirmed(!1)},change:[function(t){var a=e.value,n=t.target,r=!!n.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);n.checked?i<0&&(e.value=a.concat([o])):i>-1&&(e.value=a.slice(0,i).concat(a.slice(i+1)))}else e.value=r},function(t){return e.onValueConfirmed(!1)}]},slot:"input"})])},ke=[],De={name:"DFWidgetInput",components:{DFWidgetBase:ee},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},computed:{inputType(){return this.def.render_params.input_type},maxLength(){return this.def.render_params.max_length||1<<24},isTextArea(){return!0===this.def.textarea},value:{get:function(){return this.data[this.def.name]},set:function(e){this.data[this.def.name]=e}}},methods:{onValueConfirmed(e){this.$emit("onValueConfirmed",e)}}},je=De,Oe=Object(G["a"])(je,Ce,ke,!1,null,null,null),Fe=Oe.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DFWidgetBase",{attrs:{def:e.def,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}},[a("div",{staticClass:"input-group",attrs:{slot:"input"},slot:"input"},["checkbox"===e.passwordFieldType?a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{id:e.def.uuid,name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,placeholder:e.def.placeholder,pattern:e.def.render_params.pattern,type:"checkbox"},domProps:{value:e.value,checked:Array.isArray(e.value)?e._i(e.value,e.value)>-1:e.value},on:{change:function(t){var a=e.value,n=t.target,r=!!n.checked;if(Array.isArray(a)){var o=e.value,i=e._i(a,o);n.checked?i<0&&(e.value=a.concat([o])):i>-1&&(e.value=a.slice(0,i).concat(a.slice(i+1)))}else e.value=r}}}):"radio"===e.passwordFieldType?a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{id:e.def.uuid,name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,placeholder:e.def.placeholder,pattern:e.def.render_params.pattern,type:"radio"},domProps:{value:e.value,checked:e._q(e.value,e.value)},on:{change:function(t){e.value=e.value}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],class:e.def.render_params.field_class,attrs:{id:e.def.uuid,name:e.def.name,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.name+"-help":null,placeholder:e.def.placeholder,pattern:e.def.render_params.pattern,type:e.passwordFieldType},domProps:{value:e.value,value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}}),a("span",{staticClass:"input-group-text",attrs:{id:"pwf-"+e.def.uuid},on:{click:function(t){return t.stopPropagation(),e.toggle_password.apply(null,arguments)}}},[a("IonIcon",{staticClass:"pass-icon",attrs:{name:e.isPassword?"eye-outline":"eye-off-outline"}})],1)])])},Le=[],Ee=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loaded_svg?a("div",{key:e.loaded_svg,domProps:{innerHTML:e._s(e.loaded_svg)}}):e._e()},Te=[],Ie={name:"IonIcon",props:{name:{type:String,required:!1,default:null}},data(){return{loaded_svg:""}},watch:{name(){this.loaded_svg="",this.loadSVG()}},mounted(){this.loadSVG()},methods:{loadSVG(){const e=this.name;if(window.cache_ionicon||(window.cache_ionicon={}),e)if(window.cache_ionicon[e]){if("function"===typeof window.cache_ionicon[e].then)return window.cache_ionicon[e].then(e=>{this.loaded_svg=e.data.replace(/<title>.*<\/title>/i,"")}),void(this.loaded_svg="&hellip;");this.loaded_svg=window.cache_ionicon[e]}else this.loaded_svg="&hellip;",window.cache_ionicon[e]=F.get(`https://unpkg.com/ionicons@5.5.1/dist/svg/${e}.svg`),window.cache_ionicon[e].then(t=>{this.loaded_svg=window.cache_ionicon[e]=t.data.replace(/<title>.*<\/title>/i,"")});else Object(C["noop"])()}}},Se=Ie,Ne=(a("9982"),Object(G["a"])(Se,Ee,Te,!1,null,null,null)),qe=Ne.exports,Be={name:"DFWidgetPassword",components:{IonIcon:qe,DFWidgetBase:ee},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},data(){return{passwordFieldType:"password",isPassword:!0}},computed:{value:{get:function(){return this.data[this.def.name]},set:function(e){this.data[this.def.name]=e}}},methods:{toggle_password(){this.isPassword=!this.isPassword,this.passwordFieldType="password"===this.passwordFieldType?"text":"password"}}},Me=Be,$e=(a("86fa"),Object(G["a"])(Me,Pe,Le,!1,null,"087e2658",null)),He=$e.exports,Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("DFWidgetBase",{attrs:{def:e.def,data:e.data,errors:e.errors,"show-label-or-help-text":e.showLabelOrHelpText}},[a("div",{key:e.def.uuid,staticClass:"df-select-class",attrs:{slot:"input",id:e.def.uuid,name:e.def.name,"data-value":e.selenium?e.result:null,"data-options":e.selenium?e.options_json:null},slot:"input"},[a("AMultiselect",{attrs:{options:e.options,"close-on-select":!0,"clear-on-select":!0,"hide-selected":!1,"preserve-search":!0,"preselect-first":!1,label:"text","track-by":"id",disabled:e.disabled,multiple:e.multiple,taggable:e.taggable,"aria-describedby":e.def.help_text&&e.showLabelOrHelpText?e.def.field_name+"-help":null,placeholder:e.def.placeholder},on:{select:e.onSelect,input:e.onInput,tag:e.onTag},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1)])},Ve=[],Ue=a("9ae7"),Re=a.n(Ue),We={name:"DFWidgetSelect",components:{DFWidgetBase:ee,AMultiselect:Re.a},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0}},emits:["update:modelValue"],data(){return{selected:null,disabled:!1,required:!1,selenium:!0}},computed:{options(){return this.def.choices},options_json(){return JSON.stringify(this.options)},multiple(){return this.def.render_params.multiple},taggable(){return this.def.render_params.allow_tags},result:{get(){return this.selected?this.multiple?this.selected.map(e=>e.id):this.selected.id:""},set(e){if(null!=e)if(this.multiple){const t=e.constructor===Array?e:e.split(",");this.selected=this.options.filter(e=>t.includes(""+e.id))}else this.selected=this.options.find(t=>String(t.id)===String(e));else this.selected=null}}},watch:{selected:function(){this.data[this.def.name]=this.result}},mounted:function(){this.multiple||this.def.allow_null||this.data[this.def.name]||!this.options?this.result=this.data[this.def.name]:this.result=this.options[0].id,this.selenium&&(window["setSelectValue "+this.def.uuid]=e=>{this.result=e})},destroyed:function(){this.selenium&&delete window["setSelectValue "+this.def.uuid]},methods:{onSelect(e){this.data[this.def.name]=this.result,this.$emit("itemSelected",e),this.$emit("onValueConfirmed",!0)},onInput(e){null===e&&(this.data[this.def.name]=this.result,this.$emit("itemSelected",e))},onTag(e){const t={id:e,text:e};this.def.choices.push(t),this.multiple?this.selected.push(t):this.selected=t}}},ze=We,Ke=(a("fc6c"),Object(G["a"])(ze,Ae,Ve,!1,null,"67b9e614",null)),Ge=Ke.exports,Je={name:"DFFormColumn",components:{DFWidgetInput:Fe,DFWidgetPassword:He,DFWidgetCKEditor:fe,DFWidgetSelect:Ge,DFWidgetCheckbox:re,DFWidgetFile:xe},props:{def:{type:Object,required:!0},data:{type:Object,required:!0},errors:{type:Object,required:!0},showLabelOrHelpText:{type:Boolean,default:!0},cssClasses:{type:String,default:"col"}},computed:{isGroup(){return"group"===this.def.type},isHidden(){return this.def.field.visibility.form===B.HIDDEN},columnClasses(){const e=this.def.width_classes;return e?" "+e:""}},methods:{onValueConfirmed(e){this.$emit("onValueConfirmed",e)}}},Xe=Je,Qe=(a("c72c"),Object(G["a"])(Xe,M,$,!1,null,null,null)),Ye=Qe.exports,Ze={name:"DFFormRow",components:{DFFormColumn:Ye},props:{columns:{type:Array,required:!0},data:{type:Object,required:!0},errors:{type:Object,default:()=>{}}},computed:{writableColumns(){return this.columns},isHiddenSingle(){return 1===this.writableColumns.length&&this.writableColumns[0].field.visibility.form===B.HIDDEN}}},et=Ze,tt=Object(G["a"])(et,N,q,!1,null,"b9c07eb8",null),at=tt.exports,nt={name:"DFFormLayout",components:{DFFormRow:at},mixins:[S],props:{rows:{type:Array,required:!0},uuid:{type:String,required:!0},record:{type:Object,default:null}},data(){return{errors:{}}},computed:{errorText(){const e="non_field_errors";try{if(this.errors&&this.errors[e])return this.errors[e]}catch(t){}return""}},mounted(){E.$on("formEvents_"+this.uuid,e=>{"submitErrors"===e.type&&(this.errors=e.data)})},beforeDestroy(){E.$off("formEvents_"+this.uuid)}},rt=nt,ot=Object(G["a"])(rt,T,I,!1,null,null,null),it=ot.exports,st=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.loading?a("div",[e.progress?a("div",[a("h3",[e._v(e._s(e.label))]),a("div",{staticClass:"progress progress-striped progress-bar-animated"},[a("div",{staticClass:"progress-bar",style:"width: "+e.progress+"%",attrs:{role:"progressbar","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":"progress"}},[e._v(" "+e._s(e.progress)+"% ")])])]):a("div",{staticClass:"lds-ellipsis"},[a("div"),a("div"),a("div"),a("div")])]):e._e()},lt=[],dt={name:"DFLoadingIndicator",props:{loading:{type:Boolean,required:!0},label:{type:String,required:!1,default:null},progress:{type:Number,required:!1,default:null}}},ct=dt,ut=(a("3646"),Object(G["a"])(ct,st,lt,!1,null,"d0401872",null)),pt=ut.exports,mt={name:"ModalHandler",components:{DFFormLayout:it,DFLoadingIndicator:pt},data(){return{dialogs:[],initialEventAssignDone:!1,uniqIdCounter:0,inFlightRequests:{}}},computed:{className(){return"df-modal-handler"},bootstrapDialog(){return".df-modal-handler"},currentDialog(){const e=this.dialogs.length?this.dialogs[this.dialogs.length-1]:null;return e&&(e.uniqId=e.uniqId||this.uniqIdCounter++),e},sizeClass(){const e=this.currentDialog;return e?e.large||["large","lg","modal-lg"].includes(e.size)?"modal-lg":e.small||["small","sm","modal-sm"].includes(e.size)?"modal-sm":"":"modal-sm"},headerClasses(){const e=this.currentDialog;return e&&e.header_classes||""},title(){return this.currentDialog?this.currentDialog.title:"No dialogs to show!"},body(){return this.currentDialog?this.currentDialog.body:"No dialogs have been invoked"},callback(){return this.currentDialog?this.currentDialog.callback:null},uniqId(){return this.currentDialog?this.currentDialog.uniqId:null},isComponent(){return Boolean(this.currentDialog&&this.currentDialog.body&&this.currentDialog.body.component)},uuid(){return this.currentDialog&&this.currentDialog.uuid?"dialog-"+this.currentDialog.uuid:"df-modal-handler"},isShowingProgress(){return this.currentDialog&&!0===this.currentDialog.isProgress},buttons(){const e=this.currentDialog?this.currentDialog.buttons:null,t=this.currentDialog&&e?e:[{close:"default"}];return t.map(e=>{"default"===e.close?e={label:this.gettext("Close"),classes:"btn btn-secondary",data_return:"close"}:"default"===e.yes?e={label:this.gettext("Yes"),classes:"btn btn-primary",data_return:"yes"}:"default"===e.no&&(e={label:this.gettext("No"),classes:"btn btn-secondary",data_return:"no"}),e.arias=e.arias||{};const t=(e.classes||"").split(" ");return-1===t.indexOf("btn")&&t.push("btn"),e.classes=t.join(" "),e})}},created(){v.dialog||(v.dialog=this,window.setInterval(()=>{this.progressDialogCheck()},250))},methods:{show:function(){this.initialEventAssignDone||(this.initialEventAssignDone=!0,y(this.bootstrapDialog).on("hide.bs.modal",e=>{let t=null;this.dialogs.length&&(t=this.dialogs.pop().callback),this.dialogs.length&&e.preventDefault(),t&&!0!==t.df_called&&t(null)})),y(this.bootstrapDialog).modal("show")},hide:function(){y(this.bootstrapDialog).modal("hide")},gettext:e=>e,buttonClick(e,t,a){E.$emit("tableActionExecuted_"+this.currentDialog.tableUuid,{action:t,data:this.currentDialog.body.record,modal:this,event:e}),a&&(a(t.data_return),a.df_called=!0)},message(e,t,a){this.dialogs.push({title:e,body:t,buttons:[{close:"default"}],callback:a}),this.show()},yesNo(e,t,a){this.dialogs.push({title:e,body:t,buttons:[{yes:"default"},{no:"default"}],callback:a}),this.show()},loading(){return Object.keys(this.inFlightRequests).length},oldestInFlight(){const e=this.inFlightRequests,t=Object.keys(e);return 0===t.length?{requestId:null,timestamp:null,age:null}:{requestId:t[0],timestamp:e[t[0]],age:(new Date).getTime()-e[t[0]]}},progressDialogCheck(){this.oldestInFlight().age>=250&&!this.isShowingProgress?this.showProgress():this.oldestInFlight().age>=250&&this.isShowingProgress?F.get("/dynamicforms/progress/",{headers:{"x-df-timestamp":this.oldestInFlight().timestamp}}).then(e=>{this.isShowingProgress&&(this.currentDialog.body.progress=Number(e.data.value),this.currentDialog.body.label=e.data.comment)}).catch(e=>{console.error(e)}):0===this.loading()&&this.isShowingProgress&&this.hide()},showProgress(){console.log(`Showing progress: We have ${this.loading()} active requests to server oldest is ${this.oldestInFlight().age}ms old with timestamp ${this.oldestInFlight().timestamp}.`);const e="Performing operation";this.dialogs.push({title:e,body:{component:"DFLoadingIndicator",loading:!0,label:null,progress:null,data:!0},buttons:[],callback:null,isProgress:!0}),this.show()},addRequest(e){return this.inFlightRequests[e]=(new Date).getTime(),{sequence:e,timestamp:this.inFlightRequests[e]}},removeRequest(e){e&&(delete this.inFlightRequests[e],this.progressDialogCheck())},showComponent(e,t,a){const n=e.data,r=n.dialog.actions;this.dialogs.push({uuid:n.uuid,title:n.titles[t||"new"],body:{uuid:n.uuid,rows:n.dialog.rows,record:n.record,component:n.dialog.component_name},buttons:Object.keys(r).reduce((e,t)=>(r[t].data_return={dialog_id:n.uuid,button:r[t]},e.push(r[t]),e),[]),callback:null,size:n.dialog.size,header_classes:n.dialog.header_classes,tableUuid:a}),this.show()},fromURL(e,t,a){F.get(e,{headers:{"x-viewmode":"FORM"}}).then(e=>{E.$emit("showingRESTForm",{tableUUID:a,formUUID:e.data.uuid}),this.showComponent({component:"DFFormLayout",data:e.data},t,a)}).catch(e=>{console.error(e)})}}},ft=mt,ht=Object(G["a"])(ft,b,_,!1,null,"1b59a0c3",null),gt=ht.exports,vt={name:"ModalHandler",components:{BootstrapModal:gt},computed:{component(){return v.UI}}},bt=vt,_t=Object(G["a"])(bt,f,h,!1,null,"d4d82d52",null),yt=_t.exports,wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.currentBreadcrumbsLocation.length>0?a("div",{staticClass:"nav-item breadcrumbs-component"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("nav",{attrs:{"aria-label":"breadcrumb"}},[a("ol",{staticClass:"breadcrumb"},e._l(e.currentBreadcrumbsLocation,(function(t,n){return a("li",{key:n,staticClass:"breadcrumb-item"},[a("a",{attrs:{href:t.url}},[e._v(e._s(t.breadcrumb))])])})),0)])])])]):e._e()},xt=[],Ct=(a("4de4"),a("ac1f"),a("1276"),a("498a"),a("d81d"),a("a15b"),a("5319"),a("2ef0")),kt=a.n(Ct),Dt={name:"Breadcrumbs",data:function(){return{}},computed:{currentBreadcrumbsLocation:function(){var e=window.location.pathname,t=kt.a.filter(kt.a.trim(e,"/").split("/"),(function(e){return e}));return kt.a.map(t,(function(e){var a=kt.a.indexOf(t,e),n=kt.a.take(t,a+1);return{url:"/".concat(kt.a.join(n,"/")),breadcrumb:kt.a.startCase(kt.a.replace(kt.a.replace(e,".html","")," ",""))}}))}},created:function(){},mounted:function(){},methods:{}},jt=Dt,Ot=(a("6935"),Object(G["a"])(jt,wt,xt,!1,null,"ad22cbe2",null)),Ft=Ot.exports,Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nav-item login-container login-component"},[a("div",[a("form",{staticClass:"form-inline",on:{submit:function(e){e.preventDefault()}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.loginModel["username"],expression:"loginModel['username']"}],staticClass:"form-control btn-sm",attrs:{type:"text",placeholder:"Username",name:"username"},domProps:{value:e.loginModel["username"]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.focusPassword.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.loginModel,"username",t.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.loginModel["password"],expression:"loginModel['password']"}],staticClass:"form-control btn-sm mx-1",attrs:{type:"password",placeholder:"Password",name:"psw"},domProps:{value:e.loginModel["password"]},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.makeLogin.apply(null,arguments)},input:function(t){t.target.composing||e.$set(e.loginModel,"password",t.target.value)}}}),e.socialAuth.length?a("button",{staticClass:"btn btn-sm dropdown-toggle",attrs:{type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}}):e._e(),a("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"},on:{click:e.makeLogin}},[e._v(" "+e._s(e.gettext("Login"))+" ")]),e.socialAuth.length?a("div",{staticClass:"dropdown-menu"},e._l(e.socialAuth,(function(t,n){return a("a",{key:n,staticClass:"dropdown-item",attrs:{href:t.url}},[e._v(e._s(t.title))])})),0):e._e()])]),a("notification",{attrs:{position:"top center"}})],1)},Lt=[],Et=function(e,t){return new CustomEvent(e,{detail:t})},Tt=(new CustomEvent("login",{}),new CustomEvent("logout",{})),It=new CustomEvent("project-selected",{}),St=new CustomEvent("maintenance-notification-acknowledged",{}),Nt=function(){function e(){Object(d["a"])(this,e)}return Object(c["a"])(e,null,[{key:"login",value:function(t,a){u.clear(),p.post("/account/login/",{login:t,password:a}).then((function(){e.checkLogin(!0,(function(){return window.location.href="/"}))}))}},{key:"logout",value:function(){p.post("/account/logout/").finally((function(){u.clear(),document.dispatchEvent(Tt),window.location.href="/"}))}},{key:"checkLogin",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return p.get("/account/profile/current",{hideErrorNotice:!e}).then((function(e){u.set("current-user",e.data),document.dispatchEvent(Et("login",e.data)),t&&t()})).catch((function(){u.clear()}))}}]),e}(),qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("notifications",{attrs:{width:e.width,position:e.position},scopedSlots:e._u([{key:"body",fn:function(t){var n=t.item,r=t.close;return[a("div",{staticClass:"vue-notification",class:n.type,on:{click:function(e){return n.data.onNotificationClose(n,r,!0)}}},[a("div",[a("div",{staticClass:"notification-title",staticStyle:{display:"inline-block","max-width":"95%"}},[a("div",{domProps:{innerHTML:e._s(n.title)}})]),a("div",{staticClass:"notification-content",staticStyle:{display:"inline-block","max-width":"95%"}},[a("div",{staticStyle:{"margin-left":"0.4em"},domProps:{innerHTML:e._s(n.text)}})]),-1===n.data.duration?a("div",{staticStyle:{display:"inline-block",float:"right","vertical-align":"middle"}},[a("button",{staticClass:"close",on:{click:function(e){return n.data.onNotificationClose(n,r)}}},[a("i",{staticClass:"fas fa-times fa-xs"})])]):e._e()])])]}}])})},Bt=[],Mt=(a("a9e3"),a("7f06")),$t=a("a41d");Mt["a"].install(n["a"]);var Ht={name:"Notification",components:{Notifications:$t["a"]},props:{width:{type:Number,default:350},position:{type:String,default:"top center"}}},At=Ht,Vt=Object(G["a"])(At,qt,Bt,!1,null,"3c5eec05",null),Ut=Vt.exports,Rt={name:"Login",components:{Notification:Ut},data:function(){return{loginModel:{username:null,password:null},socialAuth:[]}},mounted:function(){Nt.checkLogin(!1,this.checkLoginSuccessCallback)},methods:{checkLoginSuccessCallback:function(){var e=this;u.get("current-user")||p.get("/account/social-auth-providers/").then((function(t){e.socialAuth=t.data}))},makeLogin:function(){Nt.login(this.loginModel.username,this.loginModel.password)},focusPassword:function(){document.getElementsByName("psw")[0].focus()}}},Wt=Rt,zt=(a("6049"),Object(G["a"])(Wt,Pt,Lt,!1,null,"b81dbd9e",null)),Kt=zt.exports,Gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nav-item project-list-dropdown projectlist-component"},[a("div",{staticClass:"collapse navbar-collapse"},[a("ul",{staticClass:"navbar-nav"},[a("li",{staticClass:"nav-item dropdown"},[a("i",{staticClass:"nav-link fas fa-th-list fa-2x",attrs:{"data-toggle":"dropdown"}}),a("div",{staticClass:"dropdown-menu",staticStyle:{left:"-4em"},attrs:{"aria-labelledby":"navbarDropdown"}},[e._l(e.projectList,(function(t){return a("a",{key:t[e.projectTablePkName],staticClass:"dropdown-item project-item",attrs:{href:"#"},on:{click:function(a){return e.projectSelected(t[e.projectTablePkName])}}},[a("img",{staticClass:"project-link-image",attrs:{src:t.logo}}),e._v(e._s(t.name))])})),e.permissions["add-project"]?a("a",{staticClass:"dropdown-item project-item",attrs:{href:"#"},on:{click:e.addNewProject}},[a("i",{staticClass:"fas fa-plus-circle"}),e._v(e._s(e.gettext("Add new project")))]):e._e()],2)])])])])},Jt=[],Xt="slug",Qt=function(){function e(){Object(d["a"])(this,e)}return Object(c["a"])(e,[{key:"getProjects",value:function(e){return u.get("current-user")?p.get("/project").then((function(t){e(t.data)})).catch((function(t){e([]),console.error(t)})):null}},{key:"getPermissions",value:function(e){var t=u.get("user-permission");t&&e(t);var a={},n=new Promise((function(e){setTimeout((function(){a={"add-project":!0,"impersonate-user":!0},u.set("user-permission",a),e()}),100)}));n.then((function(){e(a)}))}}]),e}(),Yt=Qt,Zt={name:"ProjectList",data:function(){return{projectList:[],permissions:{},dataStore:new Yt,isLoadingData:!1}},computed:{projectTablePkName:function(){return Xt}},created:function(){var e=this;u.get("current-user")&&this.loadData(),document.addEventListener("login",(function(){e.loadData()}))},methods:{projectSelected:function(e){var t=this;e!==u.get("current-project")&&(u.set("current-project",kt.a.first(kt.a.filter(this.projectList,(function(a){return a[t.projectTablePkName]===e})))[this.projectTablePkName]),document.dispatchEvent(It))},loadData:function(){var e=this;if(!this.isLoadingData){this.isLoadingData=!0;var t=this.dataStore.getProjects(this.setProjects);t?t.finally((function(){e.isLoadingData=!1})):this.isLoadingData=!1,this.dataStore.getPermissions(this.setPermissions)}},setProjects:function(e){this.projectList=e},setPermissions:function(e){this.permissions=e},addNewProject:function(){i("Make project","TODO")}}},ea=Zt,ta=(a("c52a"),Object(G["a"])(ea,Gt,Jt,!1,null,"60a89ac1",null)),aa=ta.exports,na=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"titlebar-app titlebar-component"},[a("nav",{staticClass:"navbar navbar-expand-lg",class:e.darkOrLightMode},[e.titleBarProps.name||e.titleBarProps.logo?a("div",{staticClass:"navbar-brand",staticStyle:{cursor:"default"}},[e.titleBarProps.logo?a("img",{staticClass:"float-left rounded-circle logo-image",attrs:{src:e.titleBarProps.logo,onclick:"window.location.href='/'"}}):e._e(),e._v(" "+e._s(e.titleBarProps.name||"")+" ")]):e._e(),e.breadcrumbsComponent&&e.loggedIn?a("div",[a(e.breadcrumbsComponent,{tag:"component"})],1):e._e(),a("div",{staticClass:"collapse navbar-collapse mr-auto"}),e.projectlistComponent&&e.loggedIn?a("div",{staticClass:"collapse navbar-collapse"},[a("ul",{staticClass:"navbar-nav"}),a(e.projectlistComponent,{tag:"component"})],1):e._e(),e.userprofileComponent&&e.loggedIn?a("div",[a(e.userprofileComponent,{tag:"component"})],1):!e.loggedIn&&e.loginVisible?a("div",{staticClass:"login"},[a("Login")],1):e._e()]),a("notification")],1)},ra=[],oa=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"navbar-nav"},[a("li",{staticClass:"nav-item dropdown userprofile-component"},[a("a",{staticClass:"nav-link dropdown-toggle text-nowrap",attrs:{id:"navbarDropdown",href:"#",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e.componentData.avatar?a("img",{staticClass:"d-inline-block align-top size-2",attrs:{src:e.componentData.avatar}}):e._e(),e.displayName?a("h5",{staticClass:"d-inline-block"},[e._v(" "+e._s(e.displayName)+" "),e.isImpersonated?a("span",[e._v("("+e._s(e.gettext("Impersonated"))+")")]):e._e()]):e._e()]),a("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"navbarDropdown"}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:e.userProfile}},[e._v(e._s(e.gettext("User profile")))]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:e.changePassword}},[e._v(e._s(e.gettext("Change password")))]),e.permissions["impersonate-user"]&&!e.isImpersonated?a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:e.showImpersonateLogin}},[e._v(e._s(e.gettext("Impersonate user")))]):e.isImpersonated?a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:e.stopImpersonation}},[e._v(e._s(e.gettext("Stop impersonation")))]):e._e(),a("div",{staticClass:"dropdown-divider"}),a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:e.makeLogout}},[e._v(e._s(e.gettext("Logout")))])])])])}),ia=[];a("4989");const sa=e=>{const t=t=>{e.then&&e.then(t)},a=t=>{e.catch&&e.catch(t)},n=()=>{e.finally&&e.finally()};let r;r=["put","post","patch"].includes(e.method)?[e.url,e.data,e.config]:[e.url,e.config],F[e.method].apply(void 0,r).then(e=>{t(e)}).catch(e=>{a(e)}).finally(()=>{n()})},la={methods:{executeTableAction(e,t,a,n){if(k.a.size(e))if("delete"===e.name){const e=n&&n.detailUrl?n.detailUrl:this.detail_url.replace("--record_id--",t.id);sa({method:"delete",url:e,then:n.then||(()=>{this&&this.processedConfiguration&&this.processedConfiguration.rows.deleteRow(t.id)})})}else if(["edit","add"].includes(e.name))this.showModal(e,t);else if("submit"===e.name){let e,r;t.id?(e=t.id,r="put"):(e="new",r="post"),r=n.submitMethod||r;const o=n&&n.detailUrl?n.detailUrl:this.detail_url.replace("--record_id--",e),i=n&&"headers"in n?n.headers:{"x-viewmode":"TABLE_ROW","x-pagination":1,"x-df-component-def":!0},s=this;sa({method:r,url:o,data:t,config:{headers:i},then:n.then||(e=>{a&&a.hide(),s&&s.processedConfiguration&&s.processedConfiguration.rows.updateRowFromForm(e.data)}),catch:n.catch||(e=>{const t={},n="formEvents_"+a.currentDialog.body.uuid;400===e.response.status?k.a.forOwn(e.response.data,(e,a)=>{t[""+a]=k.a.join(e,"\n")}):t.non_field_errors=e.response.data.detail,E.$emit(n,{type:"submitErrors",data:t})})})}else"cancel"===e.name?a&&a.hide():"filter"===e.name&&this.loadData()}}};var da=la,ca=a("1157"),ua=a.n(ca),pa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative"}},[e._t("form-error",(function(){return[e.getErrorText?a("div",[a("small",{staticClass:"form-text text-danger",attrs:{id:"form-"+e.uuid+"-err"}},[e._v(e._s(e.getErrorText))]),a("hr")]):e._e()]})),a("input",{directives:[{name:"model",rawName:"v-model",value:e.record["user"],expression:"\n/* eslint-disable */\nrecord['user']"}],staticClass:"autocomplete form-control",attrs:{type:"text",id:"userAutocomplete","data-toggle":"dropdown",placeholder:e.searchUserPlaceholder},domProps:{value:e.record["user"]},on:{keyup:e.searchUsers,input:function(t){t.target.composing||e.$set(e.record,"user",t.target.value)}}}),a("ul",{staticClass:"dropdown-menu",staticStyle:{width:"100%"},attrs:{role:"menu"}},e._l(e.usersFilter,(function(t,n){return a("li",{key:"key_"+t.id+"_"+n,staticClass:"cursor-pointer",staticStyle:{width:"100%",padding:"0 .75rem"},on:{click:function(a){return e.selectUser(t)}}},[a("a",[e._v(e._s(t.full_name||t.email))])])})),0)],2)},ma=[],fa={name:"accounts-impersonate_dialog.html",props:{uuid:{type:String,required:!0},record:{type:Object,required:!0}},data:function(){return{usersFilter:[],errors:{}}},computed:{searchUserPlaceholder:function(){return this.gettext("Enter any user attribute")},userSearchInputQueryString:function(){return this.record.user},getErrorText:function(){try{var e="";return kt.a.forIn(this.errors,(function(t,a){e+="".concat(t,"\n")})),e=e.trim(),e}catch(t){}return""}},mounted:function(){var e=this;E.$on("formEvents_".concat(this.uuid),(function(t){"submitErrors"===t.type&&(e.errors=t.data)}))},beforeDestroy:function(){E.$off("formEvents_".concat(this.uuid))},methods:{searchUsers:kt.a.debounce((function(){var e=this;if(this.userSearchInputQueryString){var t="/account/profile?search=".concat(this.userSearchInputQueryString);p.get(t).then((function(t){e.usersFilter=t.data}))}}),250),selectUser:function(e){this.record.user_id=e.id,this.record.user=e.full_name||e.email}}},ha=fa,ga=Object(G["a"])(ha,pa,ma,!1,null,null,null),va=ga.exports;n["a"].component(va.name,va);var ba="fake-uuid-chg-pass-654654-634565",_a="fake-uuid-usr-prof-654654-634565",ya="fake-uuid-imp-user-654654-634565",wa={name:"UserProfile",data:function(){return{componentData:{},permissions:{},isImpersonated:!1}},computed:{displayName:function(){return this.componentData.first_name&&this.componentData.last_name?"".concat(this.componentData.first_name," ").concat(this.componentData.last_name):this.componentData.email?this.componentData.email:this.componentData.username?this.componentData.username:null}},created:function(){this.loadData()},mounted:function(){E.$on("tableActionExecuted_".concat(ba),this.dialogBtnClick),E.$on("tableActionExecuted_".concat(_a),this.dialogBtnClick),E.$on("tableActionExecuted_".concat(ya),this.dialogBtnClick)},updated:function(){this.$nextTick((function(){ua()(".dropdown-toggle").dropdown()}))},beforeDestroy:function(){E.$off("tableActionExecuted_".concat(ba)),E.$off("tableActionExecuted_".concat(_a)),E.$off("tableActionExecuted_".concat(ya))},methods:{loadData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(new Yt).getPermissions((function(t){e.permissions=t})),this.isImpersonated=!!u.get("impersonated-user");var a=u.get("current-user");if(!a||t)return new Promise((function(t,a){p.get("/account/profile/current").then((function(a){e.componentData=a.data,u.set("current-user",e.componentData),t()})).catch((function(e){a(e)}))}));this.componentData=a},makeLogout:function(){Nt.logout()},showImpersonateLogin:function(){window.dynamicforms.dialog.fromURL("/account/impersonate/new.componentdef","new",ya)},reloadAfterImpersonationChange:function(){this.loadData(!0).finally((function(){window.location.href="/"}))},stopImpersonation:function(){var e=this;p.post("/account/impersonate/end").then((function(){u.delete("impersonated-user"),e.reloadAfterImpersonationChange()}))},userProfile:function(){window.dynamicforms.dialog.fromURL("/account/profile/".concat(this.componentData.id,".componentdef"),"edit",_a)},changePassword:function(){window.dynamicforms.dialog.fromURL("/account/change-password/new.componentdef","new",ba)},dialogBtnClick:function(e){var t,a,n=this;"cancel"!==e.action.name&&(e.modal.currentDialog.tableUuid===ba?(t={old_password:e.data.old_password,password:e.data.password,password_confirm:e.data.password_confirm},a={detailUrl:"/account/change-password/submit-change/",headers:void 0}):e.modal.currentDialog.tableUuid===_a?(t=e.data,a={detailUrl:"/account/profile/".concat(this.componentData.id,".json")}):e.modal.currentDialog.tableUuid===ya&&(t={id:e.data.user_id},a={detailUrl:"/account/impersonate/start",submitMethod:"post",headers:void 0,then:function(){n.impersonateModalVisible=!1,u.set("impersonated-user",!0),n.reloadAfterImpersonationChange()}})),da.methods.executeTableAction(e.action,t,e.modal,a)}}},xa=wa,Ca=(a("df19"),Object(G["a"])(xa,oa,ia,!1,null,"6e92eacc",null)),ka=Ca.exports,Da={name:"TitleBar",components:{Notification:Ut,Breadcrumbs:Ft,Login:Kt,ProjectList:aa,UserProfile:ka},props:{darkMode:{type:Boolean,default:!1},projectlistComponent:{type:String,default:"ProjectList"},userprofileComponent:{type:String,default:"UserProfile"},breadcrumbsComponent:{type:String,default:"Breadcrumbs"},loginVisible:{type:Boolean,default:!0}},data:function(){return{titleBarProps:{},loggedIn:null,lightClass:"navbar-light bg-light",darkClass:"navbar-dark bg-dark",maintenanceNoticesPeriodicApiCall:null,maintenanceNotificationItem:null}},computed:{darkOrLightMode:function(){return this.darkMode?this.darkClass:this.lightClass}},beforeDestroy:function(){clearInterval(this.maintenanceNoticesPeriodicApiCall),this.maintenanceNoticesPeriodicApiCall=null},created:function(){Nt.checkLogin(!1,this.createdCallback)},methods:{createdCallback:function(){var e=this;document.title&&(this.titleBarProps.name=document.title),this.loggedIn=null!==u.get("current-user")&&void 0!==u.get("current-user"),this.loadData(),document.addEventListener("login",(function(t){t.detail&&t.detail["default-project"]?e.titleBarProps=t.detail["default-project"]:e.loadData(),e.loggedIn=!0})),document.addEventListener("logout",(function(){e.loggedIn=null,e.titleBarProps={}})),document.addEventListener("project-selected",(function(){e.loadData()})),document.addEventListener("maintenance-notification-acknowledged",(function(){e.maintenanceNotificationItem=null})),this.monitorMaintenanceNotifications()},loadData:function(){this.loadProjectData()},loadProjectData:function(){var e=this;u.get("current-project")&&p.get("/project/".concat(u.get("current-project"))).then((function(t){e.titleBarProps=t.data}))},monitorMaintenanceNotifications:function(){var e=this;this.maintenanceNoticesPeriodicApiCall=setInterval((function(){u.get("current-user")&&p.get("/maintenance-notification/",{hideErrorNotice:!0}).then((function(t){var a=kt.a.first(t.data);if(a){var n=a.notification_acknowledged_data,r=a.delayed_to_timestamp,o=[r-36e3,r-7200-1],i=[r-7200,r-600-1],l=[r-600,r],d=Math.floor(Date.now()/1e3),c=8,u=kt.a.inRange(d,o[0],o[1])&&!kt.a.size(kt.a.filter(n,(function(e){return 8===e}))),m=kt.a.inRange(d,i[0],i[1])&&!kt.a.size(kt.a.filter(n,(function(e){return 1===e}))),f=kt.a.inRange(d,l[0],l[1])&&!kt.a.size(kt.a.filter(n,(function(e){return 5===e})));m&&(c=1),f&&(c=5),!e.maintenanceNotificationItem&&(u||m||f)&&(e.maintenanceNotificationItem=a,s(e.maintenanceNotificationItem,c,(function(){p.post("/maintenance-notification/acknowledged/",{id:e.maintenanceNotificationItem.id,acknowledged_identifier:c}).then((function(){document.dispatchEvent(St)}))})))}})).catch()}),45e3)}}},ja=Da,Oa=(a("ae40"),Object(G["a"])(ja,na,ra,!1,null,"5d76e666",null)),Fa=Oa.exports,Pa={TitleBar:Fa,Breadcrumbs:Ft,Login:Kt,ProjectList:aa,UserProfile:ka,Notification:Ut},La=function(e,t,a){return"undefined"===typeof window.dynamicforms&&(window.dynamicforms={}),!window.dynamicforms.dialog&&a&&new n["a"]({el:"#".concat(a),components:{ModalHandler:yt},template:"<ModalHandler></ModalHandler>"}),new n["a"]({el:"#".concat(e),components:Pa,template:t})},Ea=La;a("150b");"undefined"===typeof window.gettext&&(window.gettext=function(e){return e}),n["a"].config.productionTip=!1,n["a"].prototype.gettext=window.gettext,window.Vue=n["a"],window.createApp=Ea,window.showNotification=i,window.showGeneralErrorNotification=l,window.apiClient=p,window.Store=u,window.ProjectBaseData=Yt},6049:function(e,t,a){"use strict";a("b85f")},6935:function(e,t,a){"use strict";a("e60a")},"86fa":function(e,t,a){"use strict";a("0e0f")},9123:function(e,t,a){},9982:function(e,t,a){"use strict";a("df4f")},"9f3e":function(e,t,a){},adc5:function(e,t,a){},ae40:function(e,t,a){"use strict";a("154a")},b85f:function(e,t,a){},bc54:function(e,t,a){},c52a:function(e,t,a){"use strict";a("fb75")},c72c:function(e,t,a){"use strict";a("9f3e")},df19:function(e,t,a){"use strict";a("adc5")},df4f:function(e,t,a){},e60a:function(e,t,a){},fb75:function(e,t,a){},fc6c:function(e,t,a){"use strict";a("9123")}});
//# sourceMappingURL=django-project-base.js.map